<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="Максим Сохацький" />
    <title>2021-12-23</title>
    <link rel="stylesheet" href="../../blank.css" />
    <link rel="stylesheet" href="../../journal.css" />
</head>
<body>
<nav>
    <a href='../../index.html'>5HT</a>
    <a href='../index.html'>ТОП</a>
    <a href='#'>2021-12-23</a>
</nav>
<main>
    <section>
        <h3>Аудіо</h3>

          <p>Коротко: У цій статті йтиметься про основи цифрової обробки сигналів,
             а також способи побудови аудіосистем для відтворення звуку.</p>

        <p>— Формати PCM і DSD<br>
           — Структура аудіотракту<br>
           — Усунення помилок<br>
           — Чистий DSD тракт<br>
           </p>


        <h3>Формати PCM і DSD</h3>

            <p>Цифрова обробка сигналів головним чином базується на двох форматах представлення даних:
               PCM для даних, записаних за допомогою імпульсно-кодової модуляції (ІКМ),
               а також DSD для даних, записаних за допомогою широтно-імпульсної модуляції (ШІМ) з частотно-залежною негативною зворотною зв’язкою.</p>


            <p>На відміну від ІКМ, ШІМ дозволяє використовувати для обробки звукового сигналу
               досить грубі перетворювачі з кількістю бітів аж до одного, забезпечуючи при цьому
               співвідношення сигнал/шум (SNR) до 120...140 дБ, що необхідно для професійного запису звуку.</p>

            <p>При ШІМ DSD, чим нижча частота звукового сигналу, тим більше вибірок на його період, і навпаки,
               чим вища частота, тим менше вибірок на її період. Відповідно до теореми Найквіста, верхній граничній
               частоті відповідають дві вибірки на її період і дворівневе квантування. Для розглянутої ШІМ
               це умова відповідає часовому інтервалу, в якому відбувається дві вибірки на період звукового сигналу.
               Цей інтервал дорівнює 8 тактам. Це означає, що частота Найквіста при ШІМ у 8 разів менша за f<sub>sk</sub>, а не в 2, як для ІКМ.
               Тому, щоб закодувати діапазон 20 кГц, потрібно в 4 рази більший бітрейт.</p>

        <p><img src="img/image_2021-12-23_07-26-31.jpg" width=400>
           <img src="img/image_2021-12-23_07-26-51.jpg" width=400></p>

        <p>Насправді такі поняття, як об’єм і чистота сцени, залежать від імпульсної характеристики
           (вихідний сигнал динамічної системи як реакція на вхідний сигнал у вигляді дельта-функції Дірака),
           яку можна перевірити, задавши на вході -6 дБ протягом 3 мікросекунд і подивившись на графік.</p>

        <figure><img src="img/ImpulseResponse.png"></figure>

        <p>Важливою відмінною особливістю сигма-дельта модуляції є одночасне використання
           трьох аудіотехнологій: дитерингу, оверсемплінгу та формування шуму. За допомогою цих технологій
           помилки квантування перетворюються на шум, спектр шуму розширюється в область ультразвукових
           частот і трансформується так, що його спектральна щільність потужності в звуковому діапазоні
           значно зменшується, а в області високих частот, далеко за межами частоти Найквіста, зростає.</p>

        <h3>Структура тракту</h3>

<figure><code>                    АЦП                                    ЦАП
            +-----------------+                    +-----------------+
+-----+     | +-----+ +-----+ |     +--------+     | +-----+ +-----+ |     +---------+
| Мік |-[M]-|-| DSD |-| PCM |-|-[I]-| РЕДАКТОР |-[T]-|-| PCM |-| DSD |-|-[S]-| Динамік |
+-----+     | +-----+ +-----+ |     +--------+     | +-----+ +-----+ |     +---------+
            +-----------------+                    +-----------------+
</code></figure>

        <h4>PCM ЦАП</h4>

        <h4>Резисторні драбини</h4>

        <p>Перші DSD ЦАП були побудовані на основі резистивної матриці постійного
           імпедансу (резисторної драбини R-2R). Такі ЦАП мають проблеми з
           нелінійністю через допуски резисторів: нелінійність спричиняє спотворення.
           Крім того, при ультразвуковому впливі можуть виникати звукові
           накладання, що погіршують якість звуку.</p>

        <h4>1-бітні ΣΔ-модулятори</h4>

        <p>На відміну від імпульсно-кодової модуляції, сигма-дельта модуляція працює на
           частоті дискретизації в 4 і більше разів вище стандартного значення, що відповідає
           вимогам теореми Найквіста. У них використовуються грубі квантувачі з
           кількістю бітів від 1 до 6 з частотно-залежною негативною зворотною зв’язкою.</p>

<figure><code>
             1/s    | E(s)
      +---+ +---+ +-+-+   +--------+
X(s) -| Σ |-| I |-| Q |-+-| ФІЛЬТР |- Y(s)
      +-+-+ +---+ +---+ | +--------+
        |               |
        +---------------+
</code></figure>

        <p>Кількість інтеграторів і, відповідно, кількість зворотних зв’язків визначають порядок
           ΣΔ-модулятора.</p>

<figure><code>                             | E
   +---+ +---+ +---+ +---+ +-+-+   +--------+
X -| Σ |-| I |-| Σ |-| I |-| Q |-+-| ФІЛЬТР |- Y
   +-+-+ +---+ +-+-+ +---+ +---+ | +--------+
     |           |               |
     +-----------+---------------+
</code></figure>

        <p>Нижче наведено приклад 1-бітного модулятора 5-го порядку, який використовувався в стандарті SACD.</p>

<figure><code>
   +---+ +---+ +---+   +---+ +---+   +---+ +---+   +---+ +---+   +---+ +---+
X -| Σ |-| Σ |-| I |-+-| Σ |-| I |-+-| Σ |-| I |-+-| Σ |-| I |-+-| Σ |-| I |-+
   +-+-+ +-+-+ +---+ | +-+-+ +---+ | +-+-+ +---+ | +-+-+ +---+ | +-+-+ +---+ |
     |     |         |   |         |   |         |   |         |   |         |
     |     +---------+   +---------+   +---------+   +---------+   +---------+
     |               |             |             |             |             |
     |               +-------------+-------------+-------------+-------------+
     |                                           |    +---+
     |                                           +----| Q |----+----- Y
     |                                                +---+    |
     +---------------------------------------------------------+
</code></figure>

        <p>Підвищення порядку інтегратора суттєво покращує SNR в області низьких частот,
           так, наприклад, для модулятора 7-го порядку рівень шуму в чутному діапазоні не перевищує -140 дБ.
           На практиці вже існують розробки модуляторів до 12-го порядку.</p>

        <figure><img src="img/SNR.PNG"></figure>

        <h4>Мультибітні модулятори</h4>

        <p>Мультибітний DSD загалом схожий на мультибітний PCM, але відрізняється від нього низкою
           ознак. PCM зазвичай містить 24 біти для всього семплу, тоді як DSD
           зберігає 5-6 бітну різницю між сусідніми семплами. В 1-бітному модуляторі
           ця різниця завжди бінарна (0 або 1), тоді як у мультибітному модуляторі
           ця різниця дорівнює розрядності модулятора. Мультибітні модулятори завжди
           кращі за однобітні за своїми характеристиками, тому є природною еволюцією однобітних.
           На початку 2000-х років 1-бітне перетворення приваблювало простотою (теоретично ідеальною лінійністю).
           Тепер ми можемо дозволити собі більше продуктивності та мультибітні DSD ЦАП,
           щоб краще розібрати деталі. Однак, оскільки мультибітні DSD ЦАП нагадують
           за своєю архітектурою мультибітні PCM ЦАП, нам доведеться розплачуватися за мультибітність додатковими фільтрами.</p>

        <h3>Усунення шумів</h3>

        <h4>Оверсемплінг</h4>

        <p>Технологія оверсемплінгу [X] полягає у застосуванні частоти дискретизації f<sub>sk</sub> у
           багато разів вище частоти sf, що відповідає вимогам теореми Найквіста.</p>

        <h4>Дитеринг</h4>

        <p>Технологія дитерингу здійснює декореляцію помилок квантування і тим самим
           перетворює дискретний спектр помилок у спектр білого шуму квантування.
           Таке перетворення здійснюється шляхом додавання на вхід квантувача [Q]
           разом з аналоговим звуковим сигналом додаткового шуму невеликого рівня від якісного генератора псевдовипадкових чисел.</p>

        <h4>Формування шуму</h4>

        <p>Технологія формування шуму полягає у застосуванні квантувача з негативною
           зворотною зв’язкою та інтегратором на його вході. Інтегратор створює частотну залежність
           шуму квантування. При цьому змінюється спектр шуму квантування таким чином, що
           потужність шуму в звуковому діапазоні зменшується, а за межами цього діапазону зростає.
           Таке зміщення спектра шуму, на жаль, супроводжується значним збільшенням загальної
           потужності шуму квантування, про що зазвичай не згадують.</p>

        <h4>Децимація</h4>

        <h4>Динамічне узгодження елементів</h4>

        <h3>Чистий DSD тракт</h3>

<figure><code>              АЦП         DSD/PCM        ЦАП
+-----+     +-----+     +--------+     +-----+     +---------+
| Мік |-[M]-| DSD |-[I]-| РЕДАКТОР |-[T]-| DSD |-[S]-| Динамік |
+-----+     +-----+     +--------+     +-----+     +---------+
</code></figure>

<figure><code>
                 ЦАП
+--------+     +-----+     +---------+
| ПЛЕЄР |-[T]-| DSD |-[S]-| Динамік |
+--------+     +-----+     +---------+

</code></figure>

        <h4>DIY компонентні DSD ЦАП</h4>

        <p>Одним із гучних і успішних прикладів мінімалістичного чистого DSD тракту є
           проєкт DSC2 Pure DSD Павла Погодіна, який отримав позитивні відгуки ще одного
           інженера-аудіофіла Андреа Чуффолі (Andrea Ciuffoli).</p>

        <figure><img src="img/DSC2.PNG"></figure>

        <p>Під наглядом Андреа у В’єтнамі також налагоджено виробництво таких чистих цифрових
           DSD плеєрів за ціною від $1200. Хлопці обіцяють прослухати і протестувати зібраний екземпляр.</p>

        <figure><img src="img/star-pure-dsd.jpg"></figure>

        <h4>DIY DSD ЦАП на FPGA</h4>

        <p>Ринок FPGA ЦАП невеликий, але всі учасники ринку є впевненими представниками в Hi-End аудіо:
           PS Audio, Chord Electronics, Exogal, Playback Designs, dCS, Holo Audio та, можливо, інші.</p>

        <p>Існують також аматорські рішення, як-от програми для платформи RISC-V, наприклад
           <a href="https://www.youtube.com/watch?v=RsP_T7GeWYM">12MHz 1-bit DSD ЦАП</a> від René Rebe bkb.</p>

        <h4>ASIC мікросхеми з режимом Direct DSD</h4>

        <p>Найпопулярніші мікросхеми з повним набором функціональності для PCM і DSD ЦАП зводяться до трьох виробників:
           Burr Brown (Texas Instruments), AKM (Asahi Kasei), ESS (Sabre), Wolfson Microelectronics (Cirrus Logic).</p>

        <p>Режим Direct DSD Bypass був лише в чипах AK4499 (насправді в багатьох TDA1547,
           PCM1792, DSD1793, AK4493, AK4497, але топовий AK4499), але у них згорів завод. Тому
           багато хто перейшов на чипи Sabre. А там немає режиму Direct DSD Bypass. Повідомляють, що AK4499 з’явиться не раніше 2023 року.</p>

    </section>
</main>
<footer>Намдак Тонпа <span class="heart"> ❤ </span> 2009—2021</footer>
</body>
</html>
