<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="Maxim Sokhatsky" />
    <title>2023-07-05 CMS</title>
    <link rel="stylesheet" href="../../blank.css" />
    <link rel="stylesheet" href="../../journal.css?v=1" />
</head>
<body>
<nav>
    <a href='../../index.html'>5HT</a>
    <a href='../index.html'>TOP</a>
    <a href='#'>2023-07-05</a>
</nav>
<main>
    <section>

    <h3>CMS S/MIME</h3>

    <p>Я бачив багато захищених месанжерів, але всі вони написані людьми, які
        занадто надихалися крипто-стартапами. Крипто-стартап --- це така тєма
        де ти вивчив як крутити чотири функції і думаєш шо готовий запропонувати
        рішення рівня NSA. Але, як показав час, вижило не багато месенжерів.
        Хочу виділити ті захищені месанжери та системи доставки повідомлень,
        які вижили і досі є актуальними, а також розказати як я створюю свій месенжер.</p>

    <h4>IRC PGP OTR</h4>

    <p>Зараз вже відмирає потроху Freenode, як відмирає Reddit та Twitter,
       але всі хто залишився в IRC перейшли в <a href="https://libera.chat">Libera.Chat</a>,
       по-справжньому осучаснений сервер з TLS та OTR плагіном. IRC &mdash; це взагалі
       можна сказати перший месенжер в історії, а PGP &mdash; перший стандарт захищеного обміну повідомленнями.
       PGP (RFC 4880) був розроблений в 1991 році Пилипом Цимерманом і в 2012 аж він став підтримувати ECDH (RFC 6637).
       OTR, або <a href="https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html">Off-the-Record</a>
       на відміну від PGP немає стандарту і був придуманий лише в 2004 році, але активно підтримується
       як плагін у багатьох месенжерах, в тому числі і для IRC. </p>

    <h4>XMPP OTR</h4>

    <p>Перший мій комерційний проект на Erlang був месенжер для малайзійської
       державної компанії, де використовувася протокол XMPP та продукт ejabberd. В
       XMPP світі широко та активно застосовується саме OTR плагін для захищеного
       обміну повідомленнями, хоча я мало бачив людей хто цим реально користується.</p>

    <h4>E-MAIL SMTP PGP</h4>

    <p>Система доставки повідомлень є беззаперечно не тільки першим прото-месенжером,
       але також і першою системою управління бізнес-процесами, тому ці поняття дуже сильно переплітаються.
       Наприклад, якшо уявити шо в месенжері всі повідомлення від невідомих кореспондентів
       попадають не в головний фід чатів, а в спецільних інбокс спочатку, а вже потім перенаправляються
       в певну папку чатів (ростер), то цим можна трохи стерти границю відмінностей в клієнській
       архітектурі між поштою та месенжерами. В SMTP світі домінуючим гравцем на ринку плагінів
       до поштових клієнтів був до недавнього часу PGP.</p>

    <h4>Нестандартизовані месенжери</h4>

    <p>До цього класу можна віднести всі стартапи до яких є хоч трохи довіри, де можна
       повністю скачати і клієнт і сервер і внести небходні зміни за потреби. Це, наприклад,
       Signal, Session, Element. Всі інші, де ви не знаєте шо відбувається, назвати захищеними месенжерами
       можна лише умовно: Telegram, WhatsApp, Threema, Wickr, Facebook, Skype, iMessages.</p>

    <h4>CMS S/MIME</h4>

    <p>Хвиля здорового глузду почала накривати захищені месенжери тільки з 1999 року,
       коли вийшов перший RFC 2630 на синтаксис криптографічних повідомлень CMS.
       Оскільки вся промислова криптографія базується на протоколах описаних в мові ASN.1
       (а це небагато не мало стандарти на CA, X.509, PKI, всі види включів RSA і ECC,
       LDAP, OCSP, TSP, а також ДСТУ стандарти захисту, такі як
       <a href="https://tonpa.guru/stream/2020/2020-02-03 Кваліфікований Електронний Підпис.htm">Кваліфікований
       Електронний Підпис</a>), то логічно аби криптографічні
       захищені повідомлення були частиною цього стандарту. Так і сталося. Текстова
       версія протоколу CMS називається S/MIME і просто містить BASE64 тіло разом з заголовками,
       що ідеально підходить до SMTP протоколу. Зараз CMS S/MIME підтримують майже всі промислові
       поштові клієнти: Thunderbird, Outlook, Postbox, Evolution, MailMate, Nine, MailDroid, iOS Mail.</p>

    <p>Я вважаю шо сучасний відкритий криптографічний месенжер побудований на державних
       стандартах повинен базуватися на цій специфікації. І мій месанжер будується на ції специфікації
       та орієнтується на неї.</p>

    <h3>Дешифрація CMS  повідомлення</h3>

    <hr>

     <p>
     [1]. <a href="https://soatok.blog/2021/11/17/understanding-hkdf/">Understanding HKDF</a><br>
     [2]. <a href="https://gist.github.com/5HT/86f25408ed74ddb090d2ed9267b33afb">CMS S/MIME compatible MUA SMTP clients</a><br>
     [3]. <a href="https://thehackernews.com/2019/04/email-signature-spoofing.html">Over Dozen Popular Email Clients Found Vulnerable to Signature Spoofing Attacks</a><br>
     </p>

    </section>
</main>
<footer><a href="https://instagram.com/5HT/">Намдак Тöнпа</a> <span class="heart">&nbsp;❤&nbsp;</span> </footer>
</body>
</html>

